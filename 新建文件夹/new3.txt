1
select essn
from works_on
where works_on.pno='p2';
2
select count(essn)
from project,works_on
where project.pname='哈同公路' and works_on.pno=project.pnumber;

3
select employee.name,employee.address
from employee,department
where department.dnumber=employee.dno and department.dname='研发部' and employee.salary>='3000';
4
select employee.name
from employee
where not exists
(
select *
from works_on
where employee.ssn=works_on.essn and works_on.pno='p1'
);
5
select employee.name
from employee
where not exists
(
select *
from dependent
where employee.ssn=dependent.essn
);
6
select first.ssn,department.dname
from employee first,employee second,department
where first.superssn=second.ssn and second.name='张红' and second.dno=department.dnumber;
7
select essn
from works_on
group by essn
having count(*)>3;
8
select first.essn
from works_on first,works_on second
where first.pno='p1'and second.pno='p2'and first.essn=second.essn;
9
select employee.name,employee.ssn
from employee 
where  not exists
(
select *
from project
where not exists
(
select *
from works_on
where  works_on.essn=employee.ssn and works_on.pno=project.pnumber
)
);
10
select name
from employee
where salary<
(
select salary
from employee
where  employee.name='张三')
and
ssn in
( select essn
from works_on
where pno='p2'
);
11
select name
from employee
where ssn in
( 
select essn
from works_on
where pno not in
(
select pno
from employee,works_on
where employee.name='张三' and employee.ssn=works_on.essn
)
);
12
SELECT name 
FROM employee
WHERE name!="王二" AND NOT EXISTS(
	SELECT *
	FROM works_on w1
	WHERE essn in(
		SELECT ssn
		FROM employee
		WHERE name="王二"
	)AND NOT EXISTS(
	SELECT *
	FROM works_on w2
	WHERE w2.essn=ssn AND w2.pno=w1.pno
  )
);
13
select employee.name,avg(hours)
from employee,works_on
where employee.ssn=works_on.essn and essn in
(
select first.essn
from works_on first,works_on second
where first.pno!=second.pno and first.essn=second.essn and first.hours>='100' and second.hours>='100'
)
group by name;
14
select name from employee where ssn in		
(select works_on.essn Essn from works_on, project where works_on.pno = project.pnumber
group by essn
having count( distinct project.dnum)>=3);
15
select distinct employee.name
from employee,works_on
where employee.ssn=works_on.essn and essn in
(
select first.essn
from works_on first,works_on second,works_on third
where first.essn=second.essn and second.essn=third.essn and first.pno='p1' and second.pno='p2' and third.pno='p3'
);
1
create view view1
as
select employee.ssn,employee.name,department.dname,employee.salary
from employee,department
where employee.dno=department.dnumber;
2
create view view2
as
select ssn,name,count(pno)
from employee,works_on
where employee.ssn=works_on.essn
group by essn;
3
create view view3
as
select department.dnumber,avg(salary)
from employee,department
where department.dnumber=employee.dno
group by dnumber;
4
select dname,name
from view1
where salary>'3000';


